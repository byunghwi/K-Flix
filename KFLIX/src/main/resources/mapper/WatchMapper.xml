<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.kflix.mapper.WatchMapper">


	<!-- 뮤비 -->
	<select id="getAllmovie"
		resultType="com.kflix.watch.domain.MovieVO">
		SELECT * FROM movie
	</select>
	
	<select id="getmovieRanking"
		resultType="com.kflix.watch.domain.MovieVO">
		<![CDATA[SELECT * FROM movie WHERE ROWNUM <= 10 ORDER BY MOVIE_RANK DESC]]>
	</select>

	<select id="getmovie"
		resultType="com.kflix.watch.domain.MovieVO">
		SELECT * FROM movie WHERE movie_id = #{movie_id }
	</select>
	
	<!-- 와치 -->
	<select id="getAllwatch"
		resultType="com.kflix.watch.domain.WatchVO">
		SELECT * FROM watch
	</select>

	<select id="getSelectWatch"
		resultType="com.kflix.watch.domain.WatchVO">
		SELECT * FROM watch WHERE email = #{email }
	</select>
	
	<select id="getSelectWatching"
		resultType="com.kflix.watch.domain.WatchVO">
		SELECT * FROM watch WHERE email = #{email } and watch_type = 'WATCHING'
	</select>

	<select id="getSelectWatchUser"
		resultType="com.kflix.watch.domain.WatchVO">
		SELECT * FROM watch WHERE email = #{email } and movie_id =
		#{movie_id }
	</select>

	<insert id="createWatch">
		INSERT INTO watch VALUES (
		watchid_seq.nextval,
		'WATCHING',
		#{movie_id},
		#{email},
		#{watch_date},
		#{view_point}
		)
	</insert>

	<update id="updateWatch">
		UPDATE watch
		SET
		watch_type = #{watch_type},
		view_point
		= #{view_point}
		WHERE email = #{email} and movie_id = #{movie_id}
	</update>

	<delete id="deleteWatch">
		DELETE FROM watch
		WHERE email = #{email} and movie_id
		= #{movie_id}
	</delete>

	<!-- 위시 -->
	<select id="getSelectWish"
		resultType="com.kflix.watch.domain.WishVO">
		SELECT * FROM wish WHERE email = #{email }
	</select>

	<select id="getSelectWishUser"
		resultType="com.kflix.watch.domain.WishVO">
		SELECT * FROM wish WHERE email = #{email } and movie_id =
		#{movie_id }
	</select>

	<insert id="createWish">
		INSERT INTO wish VALUES (
		wishid_seq.nextval,
		#{movie_id},
		#{email}
		)
	</insert>

	<delete id="deleteWish">
		DELETE FROM wish
		WHERE email = #{email} and movie_id =
		#{movie_id}
	</delete>

	<!-- 장르 -->

	<select id="getAllGenre"
		resultType="com.kflix.genre.domain.Genre">
		SELECT * FROM genre
	</select>

</mapper>